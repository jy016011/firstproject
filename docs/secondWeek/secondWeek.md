# 📖 스프링부트3 자바 백엔드 개발 입문 2주차

---

## 🚪 6일차: 게시판 내 페이지 이동하기

### 1. 링크와 다이렉트

- 링크: 미리 정해 놓은 요청을 간편히 전송하는 기능
    - 페이지 이동을 위해 사용
    - HTML의 `<a>` 혹은 `<form>` 태그로 작성
- 리다이렉트: 클라이언트가 보낸 요청을 마친 후 계속해서 처리할 다음 요청 주소를 재지시하는 것
    - 리다이렉트를 받은 클라이언트는 해당 주소로 다시 요청을 보내고 서버는 이에 대한 결과를 응답
    - 페이지 리다이렉트에 관련된 HTTP 상태 코드는 주로 300번대에 존재
        - 그 중 302번 상태 코드가 제일 많이 사용되며, 이는 클라이언트가 요청한 리소스에 대한 답으로 서버가 설정한 URL로 리다이렉트 됐음을 나타냄

### 2. 링크를 통해 페이지 연결하기

- 이동이 필요한 페이지의 뷰 템플릿에 `<a>` 혹은 `<form>`태그에 이동하고자 하는 페이지 URL을 집어넣음으로써 다른 페이지로의 연결을 형성

### 3. 리다이렉트를 통해 페이지 연결

- 지금까지는 글 작성 후 POST 요청을 통해 DB에 글을 저장하지만, 잘 저장되었다고 알려주는 웹 페이지가 없었음
    - 이를 위해 POST 요청을 담당하는 컨트롤러 함수의 반환 값에 `return "redirect:URL주소"`를 넣음으로써 리다이렉트함.
    - 실습 간에는 글의 상세 페이지를 리턴하기위해 `/articles/show/{id}`로 리다이렉트함.
    - 클라이언트는 `/articles/show/{id}`로 다시 요청하라는 응답을 받아 `/articles/show/{id}`로 GET 요청을 보냄
    - 서버는 GET요청을 받아 해당하는 뷰를 반환

---

## 🖍️ 7일차: 게시글 수정하기(Update)

### 1. 데이터 수정 과정

- 기존 데이터를 불러와 수정 페이지 반환하기
    1. `show` 페이지에서 `Èdit` 버튼 클릭
    2. 요청을 받은 컨트롤러는 해당 글의 Id로 데이터를 찾아 불러옴
    3. 불러온 데이터를 컨트롤러가 모델에 등록
    4. 모델에 등록된 데이터를 수정 페이지에 적용하여 보여줌
- 수정한 데이터를 DB에 반영 후 반영 결과를 `show` 페이지로 리다이렉트하여 보여주기
    1. 폼 데이터(수정 요청 데이터)를 DTO에 담아 컨트롤러에서 받음
    2. DTO를 엔터티로 변환
    3. DB에서 기존 데이터를 수정해서 갱신
    4. `show` 페이지로 리다이렉트

### 2. 수정 페이지 반환하기

- 기존의 `show` 템플릿에 `articles/{{id}}/edit` 경로로 `Edit`버튼 추가
- 컨트롤러는 `articles/{{id}}/edit` 경로애 대응되는 `edit()` 함수를 통해 응답
    - 경로를 통해 받은 Id값을 이용하여 DB로부터 해당하는 Article 데이터를 불러옴
    - 불러온 데이터를 모델에 적용
    - 모델의 데이터는 `edit` 템플릿에 반영되고, 사용자에게 반환됨

### 3. DB에 수정된 데이터 적용하기

- HTTP 메서드에는 데이터 생성(`POST`), 데이터 조회(`GET`), 데이터 수정(`PATCH`), 데이터 삭제(`DELETE`)가 있음.
- 하지만 `<form>`태그에는 `GET`과 `POST`만 있어 이번 실습간에는 `POST`메서드 이용
- 사용자는 `edit` 페이지의 `Submit`버튼을 클릭하여 `/articles/update`경로로 `POST`요청 전송
- 컨트롤러는 `@PostMapping("/articles/update")`를 통해 요청에 대응
    - DTO를 통해 데이터를 받음
    - DTO를 엔터티화함
    - 엔터티의 Id를 통해 DB로부터 값을 불러옴
    - 불러온 값이 `null`이 아니라면 `save()`를 통해 해당 Id의 값을 업데이트함
    - 반영된 정보를 보여주기 위해 `show` 페이지로 리다이렉트 응답을 보냄
- SQL 업데이트 문법: `UPDATE 테이블 명 SET 속성명 = 속성값 WHERE 조건;`

### 4. 실습간 발생한 오류 및 해결

- 편의를 위해 `data.sql`을 추가하여 `INSERT`구문으로 데이터를 직접추가하였었음. 그리고 웹 브라우저를 통해 새 게시글을 작성하는 `Create`하였으나, 오류 발생
    - 앞에 데이터를 직접 넣는 `INSERT`에서 식별자인 `id`값을 임의로 넣어주어 DB에서 이후에 생성되는 데이터의 `id`를 자동증가로 넣지 않아 원래 있던 값의 `id`와 충돌
    - `INSERT`구문에서 id값 구문들(속성명, 값)을 전부 삭제하고, 엔터티의 식별자위 어노테이션 `@GeneratedValue`에 `(strategy = GenrationType.IDENTITY)`를
      추가하여 해결
    - 여기서 `GenrationType.IDENTITY`는 자동생성 전략(strategy)을 DB에게 알아서 하도록 위임한다는 말임. 그럼 DB는 자동 증가로 식별자를 생성

---

## ❌ 8일차: 게시글 삭제하기(Delete)

### 1. 데이터 삭제 과정

1. 클라이언트가 HTTP 메소드로 특정 데이터 삭제 요청을 보냄
2. 요청을 받은 컨트롤러는 해당하는 데이터가 DB에 있는지 확인하고, 있으면 DB에서 데이터를 삭제함.
3. 삭제가 완료되었다면, 결과 화면을 보여주기 위해 `index`페이지로 반환하고, 삭제가 완료되었다는 알림창도 같이 띄워줌

### 2. 데이터 삭제하기

- `show`템플릿에 `/articles/{{articles.id}}/delete`경로로 GET 요청을 보내는 삭제 버튼을 추가함.
    - HTML은 GET과 POST 요청만 되어 실습 간에는 DELETE 요청은 수행하지 않고 GET을 이용
- `/articles/{id}/delete`경로로 `GetMapping`하는 `delete()`함수를 추가하여 해당 요청을 수행
    - 경로로 들어온 `ìd`에 해당하는 데이터가 DB에 있는지 확인
    - 있는 데이터라면 DB에서 삭제하고, `RedirectAttibutes`객체의 `addFlashAttribute()`를 통해 삭제가 완료됐다는 내용의 휘발성 데이터를 담음
    - 담겨진 휘발성 데이터는 리다이렉트될 `index`페이지에 적용되어 사용자는 삭제 후 삭제가 되었다는 알림창과 함께 글목록 페이지(`index`페이지)를 보게됨.

### 3. SQL문으로 직접 데이터 삭제

- `DELETE (FROM) 테이블 명 WHERE 조건;` ()는 생략가능 문구

---
