# 📖 스프링부트3 자바 백엔드 개발 입문 3주차

---

## 💡 11일차: HTTP와 REST 컨트롤러

### 1. REST API의 동작 이해하기

- JSON의 값으로 내부에 또 다른 JSON을 넣거나, 배열을 넣을 수 있음.
- REST: HTTP URL로 서버의 자원을 명시하고, HTTP 메서드로 해당 자원에 대해 CRUD하는 것
- API: 클라이언트가 서버의 자원을 요청할 수 있도록 서버에서 제공하는 인터페이스
- REST API는 즉, REST를 기반으로 API를 구현한 것임.
    - 클라이언트가 기기에 구애받지 않고 서버의 자원 이용 가능
    - 서버 프로그램의 재사용성과 확장성이 좋아짐

### 2. REST API 구현하기

- REST API를 구현하는 컨트롤러에는 `@RestController` 어노테이션을 붙임
- REST 컨트롤러는 JSON이나 텍스트 같은 데이터를 반환(일반 컨트롤러는 뷰 페이지를 반환)
- REST API에서는 dto 매개변수 앞에 `@RequestBody`라는 어노테이션을 붙여야 요청으로 오는 JSON 데이터를 받을 수 있음.
- `ResponseEntity`클래스는 REST API의 응답을 위해 사용하는 클래스
    - REST API 요청을 받아 응답할 때 이 클래스에 HTTP 상태코드, 헤더, 본문을 실어 보낼 수 있음.
- `HttpStatus`클래스는 HTTP 상태코드를 관리하는 클래스.
    - 다양한 Enum타입과 관련 메서드를 가짐
        - `HttpStatus.OK`: HTTP 200
        - `HttpStatus.CREATED`: HTTP 201
        - `HttpStatus.BAD_REQUEST`: HTTP 400
- `PATCH`메서드의 경우 일부 데이터만 수정할 수도 있으므로 null 데이터가 덮어 쓰여지지 않도록 값이 있는 데이터만 수정되도록 주의하여 코딩할 것
    - 요청으로 들어온 수정 데이터 중 null 값이 아닌 데이터만 새로 수정한다는 지 등

---

## ⚙️ 12일차: 서비스 계층과 트랜잭션

### 1. 서비스와 트랜잭션의 개념

- 서비스: 컨트롤러와 리퍼지터리 사이에 위치하는 계층으로 서버의 비즈니스 로직(핵심 기능)을 처리하는 순서를 총괄함
    - 일반적으로 서비스는 `트랜잭션(transaction)`단위로 진행됨
- 트랜잭션: 모두 성공해야하는 쪼갤 수 없는 업무의 최소 단위
    - 트랜잭션 중간에 실패하면 이전의 트랜잭션 과정들은 모두 롤백됨

### 2. 서비스 계층 만들기

- `@Service` 어노테이션은 해당 클래스를 서비스로 인식해 스프링 부트가 서비스 객체를 생성
    - 컨트롤러는 `@Autowired`를 통해 서비스 객체를 이용할 수 있음.
- 컨트롤러는 클라이언트의 요청을 접수하고 응답하는 역할만 수행
- 서비스는 비즈니스 로직을 수행하고, 그 과정에서 필요한 데이터를 리파지터리를 통해 DB로부터 불러옴.
- 서비스는 로직을 수행한 후 엔터티 객체(혹은 `null`)을 반환
- 컨트롤러는 서비스의 반환 값에 따라 HTTP 상태 코드를 담은 응답(`ResponseEntity`)을 반환

### 3. 트랜잭션 맛보기

- 보통의 트랜잭션은 서비스에서 관리
- 서비스의 메서드에 `@Transactional`을 붙이면 해당 메서드는 하나의 트랜잭션으로 취급됨.
    - 클래스에 선언시 클래스의 모든 메서드에 각각의 트랜잭션이 부여됨.
- 중간에 작업이 실패하면 작업 시작 전 상태로 `롤백`

---

## 🧪 13일차: 테스트코드 작성하기

### 1. 테스트란

- 테스트: 프로그램의 품질을 검증하는 것으로 의도대로 프로그램이 잘 동작하는지 확인하는 과정
- 테스트의 종류
    - 통합 테스트: 서버릴 실행시켜 실제 환경과 유사한 상황에서 테스트
    - 단위 테스트: 테스트하고 싶은 메서드만 테스트
    - E2E 테스트: 서버의 경우 HTTP 응답을 테스트
- 테스트 코드 작성 과정
    1. 예상 데이터 작성하기
    2. 실제 데이터 획득하기
    3. 예상 데이터와 실제 데이터 비교해 검증하기
- 작성한 테스트 코드를 통과하면 지속적인 리팩터링으로 코드를 개선, 통과 못하면 디버깅 수행
- 테스트 코드는 성공할 경우 뽄만 아니라 실패할 경우도 고려한다. 이 경우들을 테스트 케이스라 부름
- 테스트 주도 개발(TDD) 일단 테스트 코드를 먼저 작성 후 이를 통과하는 최소한의 코드부터 시작해 점진적으로 코드를 개선 및 확장해 내가는 개발 방식

### 2. 테스트 코드 작성하기

- `test` 디렉터리는 `main/java/...` 디렉터리와 데칼코마니처럼 `test/java/...`와 같이 생성
- `@SpringBootTest`: 해당 클래스를 스프링부트와 연동해 통합테스트를 수행하겠다고 선언
    - `Autowired`를 통해 SpringContext에 있는 Bean과 필드를 묶어줌
- `@Test`: 해당 메서드가 테스트를 위한 코드라고 선언하는 어노테이션
- 테스트시 데이터 조회를 제외한 CUD 작업들은 테스트 종료 후 롤백이 필요함
    - 해딩 메서드에 `@Transactional` 사용

---
